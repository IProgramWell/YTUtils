// ==UserScript==
// @name YT Utils
// @namespace Violentmonkey Scripts
// @match https://www.youtube.com/**
// @grant none
// @version 1.4.3
// @author -
// @inject-into page
// @run-at document-start
// @description Useful YouTube utilities.
// ==/UserScript==
(()=>{"use strict";var t={275:function(t,e,o){var n,i,r,l,a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.GLOBAL_WATCHER=e.GLOBAL_MANAGER=void 0;const s=a(o(184)),u=a(o(150)),d=o(815);e.GLOBAL_MANAGER=new s.default(null!==(l=null===(r=null===(i=null===(n=globalThis.GM_info)||void 0===n?void 0:n.call(globalThis))||void 0===i?void 0:i.script)||void 0===r?void 0:r.name)&&void 0!==l?l:"YT Utils"),e.GLOBAL_WATCHER=new u.default(d.MODULES,e.GLOBAL_MANAGER)},715:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0});const n=o(375);class i extends n.AutoBound{constructor(t,e,o){if(super(),this.methods={},this.state={},this.pathRegex=/\//i,this.isActive=!1,this.moduleName=null,!e)throw new Error("Path regex not specified");this.pathRegex="string"==typeof e?new RegExp(e):e;for(let e in t||{})t[e]&&"function"==typeof t[e]&&(this.methods[e]=t[e].bind(this));o&&(this.moduleName=o)}getStateValue(t,e=null){var o;return null!==(o=this.state[t])&&void 0!==o?o:e}setStateValue(t,e){this.state[t]=e}}e.default=i},815:function(t,e,o){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.MODULES=e.YTUModule=void 0;const i=o(905),r=n(o(715));var l=o(715);Object.defineProperty(e,"YTUModule",{enumerable:!0,get:function(){return n(l).default}}),e.MODULES=[new r.default({onDocumentStart:i.noShortsOnURLChange,onModuleStart:i.noShortsOnURLChange},/^\/shorts\/.*\/?$/i,"No Shorts Redirector"),new r.default({onDocumentLoad:i.initCustomPlaylistRuntimeDisplay,onModuleStart:i.initCustomPlaylistRuntimeDisplay},/^\/playlist\/?$/i,"Custom Playlist Statistics"),new r.default({onDocumentLoad:i.noPlaylist.addNoPLControls,onModuleStart:i.noPlaylist.addNoPLControls,onModuleStop:i.noPlaylist.removeNoPLControls},/^\/watch\/?$/i,"No Playlist Controls")]},905:function(t,e,o){var n=this&&this.__createBinding||(Object.create?function(t,e,o,n){void 0===n&&(n=o);var i=Object.getOwnPropertyDescriptor(e,o);i&&!("get"in i?!e.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return e[o]}}),Object.defineProperty(t,n,i)}:function(t,e,o,n){void 0===n&&(n=o),t[n]=e[o]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),r=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var o in t)"default"!==o&&Object.prototype.hasOwnProperty.call(t,o)&&n(e,t,o);return i(e,t),e},l=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.noPlaylist=e.noShortsOnURLChange=e.initCustomPlaylistRuntimeDisplay=void 0;var a=o(685);Object.defineProperty(e,"initCustomPlaylistRuntimeDisplay",{enumerable:!0,get:function(){return l(a).default}});var s=o(701);Object.defineProperty(e,"noShortsOnURLChange",{enumerable:!0,get:function(){return l(s).default}}),e.noPlaylist=r(o(534))},534:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.removeNoPLControls=e.addNoPLControls=void 0;const n=o(960);e.addNoPLControls=function(){var t,e,o;if(!(0,n.getSearchParams)().list)return!1;const i="float: left; top: 50%; white-space: nowrap;",r="ytutils-noplaylist-newtabcheckbox",l="yt-utils-noplaylist-noplbtn";null===(t=this.setStateValue)||void 0===t||t.call(this,"newTabCheckboxID",r),null===(e=this.setStateValue)||void 0===e||e.call(this,"noPLButtonID",l);const a=Object.assign(document.createElement("input"),{type:"checkbox",id:r,style:`${i} transform: translateY(50%);`,name:r,title:"Open in new tab","aria-label":"Open in new tab"}),s=Object.assign(document.createElement("button"),{id:l,title:"Watch outside playlist","aria-label":"Watch outside playlist",onclick:()=>{var t;let e=(0,n.getSearchParams)();(null===(t=document.getElementById(r))||void 0===t?void 0:t.checked)?globalThis.GM_openInTab?GM_openInTab(`https://youtube.com/watch?v=${e.v}`):globalThis.open(`https://youtube.com/watch?v=${e.v}`,"_blank"):document.location.search=`?v=${e.v}`},innerHTML:"No Playlist",style:i});return null===(o=document.querySelector(".ytp-right-controls"))||void 0===o||o.prepend(a,s),!0},e.removeNoPLControls=function(){var t,e;return(0,n.removeElementById)(null===(t=this.getStateValue)||void 0===t?void 0:t.call(this,"newTabCheckboxID",null)),(0,n.removeElementById)(null===(e=this.getStateValue)||void 0===e?void 0:e.call(this,"noPLButtonID",null)),!1}},701:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){const[,t,e]=document.location.pathname.split("/");return"shorts"===t&&(document.location.href=`https://youtube.com/watch?v=${e}`),!0}},685:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0});const n=o(275),i=o(627);e.default=function(){let t=globalThis.ytInitialData.contents.twoColumnBrowseResultsRenderer.tabs[0].tabRenderer.content.sectionListRenderer.contents[0].itemSectionRenderer.contents[0].playlistVideoListRenderer.contents.reduce(((t,e)=>{var o,i,r;let l=Number.parseInt(e.playlistVideoRenderer.lengthSeconds),a=l-l*((null===(r=null===(i=null===(o=e.playlistVideoRenderer)||void 0===o?void 0:o.thumbnailOverlays[1])||void 0===i?void 0:i.thumbnailOverlayResumePlaybackRenderer)||void 0===r?void 0:r.percentDurationWatched)||0)/100;return n.GLOBAL_MANAGER.print(`Video "${e.playlistVideoRenderer.videoId}"`,`has a remaining watch time of ${a} seconds`,`out of ${l}.`),t.total+=l,t.remaining+=a,t}),{total:0,remaining:0}),e=`Runtime: ${(0,i.getTimeString)(t.total)}`,o=`Estimated remaining: ${(0,i.getTimeString)(t.remaining)}`;n.GLOBAL_MANAGER.print({playlistSeconds:t,runtimeString:e,remainingString:o}),globalThis.ytInitialData.sidebar.playlistSidebarRenderer.items[0].playlistSidebarPrimaryInfoRenderer.stats.push({simpleText:e},{simpleText:o});const r=document.getElementById("stats");if(r){let t=r.innerText.includes(e),i=r.innerText.includes(o);t||(r.appendChild(Object.assign(document.createElement("yt-formatted-string"),{className:"style-scope ytd-playlist-sidebar-primary-info-renderer"})).innerHTML=e),i||(r.appendChild(Object.assign(document.createElement("yt-formatted-string"),{className:"style-scope ytd-playlist-sidebar-primary-info-renderer"})).innerHTML=o),n.GLOBAL_MANAGER.print("Added time to playlist!")}else n.GLOBAL_MANAGER.print("Unable to verify time was added :(");return!0}},627:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getTimeString=void 0,e.getTimeString=function(t){let e=t,o=Math.floor(e/3600);e%=3600;let n=Math.floor(e/60);return e=Math.round(e%60),[o.toString().padStart(2,"0"),n.toString().padStart(2,"0"),e.toString().padStart(2,"0")].join(":")}},184:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0});const n=o(375);class i extends n.AutoBound{constructor(t,e=!0,o="Locale"){super(),this.scriptName=t,this.logTimestamp=e,this.timestampFormat=o}getTimestamp(){switch(this.timestampFormat){case"UTC":return(new Date).toUTCString();case"ISO":return(new Date).toISOString();case"Locale":return(new Date).toLocaleString();case"Milliseconds":return(new Date).getTime().toString();default:return(new Date).toString()}}joinPrefixes(t,e=!1){return t.map((t=>`[${t}]`)).join(" ")+":"+(e?" ":"")}getPrefix(t=!1,e=!1){return this.joinPrefixes([...t?[this.getTimestamp()]:[],this.scriptName],e)}print(...t){console.log(this.getPrefix(this.logTimestamp,!1),...t)}prompt(t,e,o=!1){return globalThis.prompt(this.getPrefix(o,!0)+t,e)}alert(t,e=!1){globalThis.alert(this.getPrefix(e,!0)+t)}}e.default=i},375:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.arrToObj=e.AutoBound=e.bindMethods=void 0,e.bindMethods=function(t,e=null,o=null){let n=[];n=t.constructor===Object?Object.keys(t):Object.getOwnPropertyNames(Object.getPrototypeOf(t)),e||(e=t),o||(o=t);for(let i of n)"constructor"!==i&&"function"==typeof t[i]&&(o[i]=t[i].bind(e))};e.AutoBound=class{constructor(){let t=Object.getOwnPropertyNames(Object.getPrototypeOf(this));for(let e of t)"constructor"!==e&&"function"==typeof this[e]&&(this[e]=this[e].bind(this))}},e.arrToObj=function(t,e=((t,e)=>e.toString()),o=(t=>t)){const n={};for(let i=0;i<t.length;i++)n[e(t[i],i,t)]=o(t[i],i,t);return n}},960:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.removeElementById=e.getSearchParams=void 0;const n=o(375);e.getSearchParams=function(){return(0,n.arrToObj)(document.location.search.substring(1).split("&"),(t=>t.substring(0,t.indexOf("="))),(t=>t.substring(t.indexOf("=")+1)))},e.removeElementById=function(t){if(!t)return;let e=document.getElementById(t);e&&e.parentNode.removeChild(e)}},150:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0});const n=o(375),i=o(275);class r extends n.AutoBound{constructor(t,e=i.GLOBAL_MANAGER){super(),this.lastPath="",this.observerInstance=new MutationObserver(this.onUrlChange),this.logger=e,this.moduleList=t}onUrlChange(){var t,e,o,n,i,r;let l,a=document.location.pathname;if(this.lastPath!==a){this.lastPath=a,this.logger.print("Changed url!",`New pathname: "${a}"`);for(let s of this.moduleList)l=s.pathRegex.test(a),s.isActive&&!l&&s.methods.onModuleStop?(s.isActive=null!==(o=null===(e=(t=s.methods).onModuleStop)||void 0===e?void 0:e.call(t))&&void 0!==o&&o,this.logger.print(`Stopped module: "${s.moduleName}" for regex: ${s.pathRegex}`)):!s.isActive&&l&&s.methods.onModuleStart&&(s.isActive=null===(r=null===(i=(n=s.methods).onModuleStart)||void 0===i?void 0:i.call(n))||void 0===r||r,this.logger.print(`Started module: "${s.moduleName}" for regex: ${s.pathRegex}`))}}start(){this.observerInstance.observe(document,{subtree:!0,childList:!0,attributeFilter:["location"]})}}e.default=r}},e={};function o(n){var i=e[n];if(void 0!==i)return i.exports;var r=e[n]={exports:{}};return t[n].call(r.exports,r,r.exports,o),r.exports}(()=>{var t,e,n;const i=o(275),r=o(815);i.GLOBAL_WATCHER.start();for(let o of r.MODULES)o.pathRegex.test(document.location.pathname)&&o.methods.onDocumentStart&&(o.isActive=null===(n=null===(e=(t=o.methods).onDocumentStart)||void 0===e?void 0:e.call(t))||void 0===n||n);globalThis.addEventListener("load",(()=>{var t,e,o;for(let n of r.MODULES)n.pathRegex.test(document.location.pathname)&&n.methods.onDocumentLoad&&(n.isActive=null===(o=null===(e=(t=n.methods).onDocumentLoad)||void 0===e?void 0:e.call(t))||void 0===o||o)}))})()})();